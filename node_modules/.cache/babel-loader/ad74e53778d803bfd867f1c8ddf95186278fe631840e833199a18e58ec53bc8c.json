{"ast":null,"code":"import { v4 as uuidv4 } from 'uuid';\nimport { actionTypes } from '../actions/actionTypes';\nimport exerciseUtils from '../utils/exercise.js';\nimport { standardizeWorkout } from '../utils/standardizeWorkout';\nfunction workoutReducer(state = {\n  workouts: [],\n  activeWorkout: null\n}, action) {\n  switch (action.type) {\n    case actionTypes.SET_ACTIVE_WORKOUT:\n      return {\n        ...state,\n        activeWorkout: action.payload\n      };\n    case actionTypes.ADD_WORKOUT:\n      {\n        const newWorkout = standardizeWorkout(action.payload);\n        if (!newWorkout) {\n          console.error('Failed to standardize workout:', action.payload);\n          return state;\n        }\n        return {\n          ...state,\n          workouts: [...state.workouts, newWorkout]\n        };\n      }\n    case actionTypes.UPDATE_WORKOUT:\n      {\n        const updatedWorkout = action.payload;\n        return {\n          ...state,\n          workouts: state.workouts.map(workout => workout.id === updatedWorkout.id ? updatedWorkout : workout)\n        };\n      }\n    case actionTypes.DELETE_WORKOUT:\n      {\n        const workoutId = action.payload;\n        return {\n          ...state,\n          workouts: state.workouts.filter(workout => workout.id !== workoutId),\n          activeWorkout: state.activeWorkout === workoutId ? null : state.activeWorkout\n        };\n      }\n    case actionTypes.ADD_EXERCISE:\n      {\n        const {\n          workoutId,\n          exercises\n        } = action.payload;\n        return {\n          ...state,\n          workouts: state.workouts.map(workout => {\n            if (workout.id === workoutId) {\n              return {\n                ...workout,\n                exercises: [...workout.exercises, ...exercises.map(ex => ({\n                  ...exerciseUtils.standardizeExercise(ex),\n                  id: ex.id || uuidv4(),\n                  tempId: ex.tempId || uuidv4()\n                }))]\n              };\n            }\n            return workout;\n          })\n        };\n      }\n    case actionTypes.REMOVE_EXERCISE:\n      {\n        const {\n          workoutId,\n          exerciseId\n        } = action.payload;\n        return {\n          ...state,\n          workouts: state.workouts.map(workout => {\n            if (workout.id === workoutId) {\n              return {\n                ...workout,\n                exercises: workout.exercises.filter(ex => ex.id !== exerciseId && ex.tempId !== exerciseId && ex.catalog_exercise_id !== exerciseId)\n              };\n            }\n            return workout;\n          })\n        };\n      }\n    case actionTypes.ADD_SET:\n      {\n        const {\n          workoutId,\n          exerciseId,\n          newSet\n        } = action.payload;\n        return {\n          ...state,\n          workouts: state.workouts.map(workout => {\n            if (workout.id === workoutId) {\n              return {\n                ...workout,\n                exercises: workout.exercises.map(exercise => {\n                  if (exercise.id === exerciseId || exercise.tempId === exerciseId) {\n                    return {\n                      ...exercise,\n                      sets: [...exercise.sets, {\n                        ...newSet,\n                        id: uuidv4()\n                      }]\n                    };\n                  }\n                  return exercise;\n                })\n              };\n            }\n            return workout;\n          })\n        };\n      }\n    case actionTypes.UPDATE_SET:\n      {\n        const {\n          workoutId,\n          exerciseId,\n          updatedSet\n        } = action.payload;\n        return {\n          ...state,\n          workouts: state.workouts.map(workout => {\n            if (workout.id === workoutId) {\n              return {\n                ...workout,\n                exercises: workout.exercises.map(exercise => {\n                  if (exercise.id === exerciseId || exercise.tempId === exerciseId) {\n                    return {\n                      ...exercise,\n                      sets: exercise.sets.map(set => set.id === updatedSet.id || set.tempId === updatedSet.tempId ? {\n                        ...set,\n                        ...updatedSet\n                      } : set)\n                    };\n                  }\n                  return exercise;\n                })\n              };\n            }\n            return workout;\n          })\n        };\n      }\n    case actionTypes.REMOVE_SET:\n      {\n        const {\n          workoutId,\n          exerciseId,\n          setId\n        } = action.payload;\n        return {\n          ...state,\n          workouts: state.workouts.map(workout => {\n            if (workout.id === workoutId) {\n              return {\n                ...workout,\n                exercises: workout.exercises.map(exercise => {\n                  if (exercise.id === exerciseId || exercise.tempId === exerciseId) {\n                    return {\n                      ...exercise,\n                      sets: exercise.sets.filter(set => set.id !== setId && set.tempId !== setId)\n                    };\n                  }\n                  return exercise;\n                })\n              };\n            }\n            return workout;\n          })\n        };\n      }\n    default:\n      return state;\n  }\n}\nexport { workoutReducer };","map":{"version":3,"names":["v4","uuidv4","actionTypes","exerciseUtils","standardizeWorkout","workoutReducer","state","workouts","activeWorkout","action","type","SET_ACTIVE_WORKOUT","payload","ADD_WORKOUT","newWorkout","console","error","UPDATE_WORKOUT","updatedWorkout","map","workout","id","DELETE_WORKOUT","workoutId","filter","ADD_EXERCISE","exercises","ex","standardizeExercise","tempId","REMOVE_EXERCISE","exerciseId","catalog_exercise_id","ADD_SET","newSet","exercise","sets","UPDATE_SET","updatedSet","set","REMOVE_SET","setId"],"sources":["/Users/mike/Documents/purple.nosync/pow/web-frontend/src/reducers/workoutReducer.js"],"sourcesContent":["import { v4 as uuidv4 } from 'uuid';\nimport { actionTypes } from '../actions/actionTypes';\nimport exerciseUtils from '../utils/exercise.js';\nimport { standardizeWorkout } from '../utils/standardizeWorkout';\n\nfunction workoutReducer(state = { workouts: [], activeWorkout: null }, action) {\n  switch (action.type) {\n    case actionTypes.SET_ACTIVE_WORKOUT:\n      return {\n        ...state,\n        activeWorkout: action.payload\n      };\n\n    case actionTypes.ADD_WORKOUT: {\n      const newWorkout = standardizeWorkout(action.payload);\n      if (!newWorkout) {\n        console.error('Failed to standardize workout:', action.payload);\n        return state;\n      }\n\n      return {\n        ...state,\n        workouts: [...state.workouts, newWorkout]\n      };\n    }\n\n    case actionTypes.UPDATE_WORKOUT: {\n      const updatedWorkout = action.payload;\n      return {\n        ...state,\n        workouts: state.workouts.map(workout =>\n          workout.id === updatedWorkout.id ? updatedWorkout : workout\n        )\n      };\n    }\n\n    case actionTypes.DELETE_WORKOUT: {\n      const workoutId = action.payload;\n      return {\n        ...state,\n        workouts: state.workouts.filter(workout => workout.id !== workoutId),\n        activeWorkout:\n          state.activeWorkout === workoutId ? null : state.activeWorkout\n      };\n    }\n\n    case actionTypes.ADD_EXERCISE: {\n      const { workoutId, exercises } = action.payload;\n      return {\n        ...state,\n        workouts: state.workouts.map(workout => {\n          if (workout.id === workoutId) {\n            return {\n              ...workout,\n              exercises: [\n                ...workout.exercises,\n                ...exercises.map(ex => ({\n                  ...exerciseUtils.standardizeExercise(ex),\n                  id: ex.id || uuidv4(),\n                  tempId: ex.tempId || uuidv4()\n                }))\n              ]\n            };\n          }\n          return workout;\n        })\n      };\n    }\n\n    case actionTypes.REMOVE_EXERCISE: {\n      const { workoutId, exerciseId } = action.payload;\n      return {\n        ...state,\n        workouts: state.workouts.map(workout => {\n          if (workout.id === workoutId) {\n            return {\n              ...workout,\n              exercises: workout.exercises.filter(\n                ex =>\n                  ex.id !== exerciseId &&\n                  ex.tempId !== exerciseId &&\n                  ex.catalog_exercise_id !== exerciseId\n              )\n            };\n          }\n          return workout;\n        })\n      };\n    }\n\n    case actionTypes.ADD_SET: {\n      const { workoutId, exerciseId, newSet } = action.payload;\n      return {\n        ...state,\n        workouts: state.workouts.map(workout => {\n          if (workout.id === workoutId) {\n            return {\n              ...workout,\n              exercises: workout.exercises.map(exercise => {\n                if (\n                  exercise.id === exerciseId ||\n                  exercise.tempId === exerciseId\n                ) {\n                  return {\n                    ...exercise,\n                    sets: [...exercise.sets, { ...newSet, id: uuidv4() }]\n                  };\n                }\n                return exercise;\n              })\n            };\n          }\n          return workout;\n        })\n      };\n    }\n\n    case actionTypes.UPDATE_SET: {\n      const { workoutId, exerciseId, updatedSet } = action.payload;\n      return {\n        ...state,\n        workouts: state.workouts.map(workout => {\n          if (workout.id === workoutId) {\n            return {\n              ...workout,\n              exercises: workout.exercises.map(exercise => {\n                if (\n                  exercise.id === exerciseId ||\n                  exercise.tempId === exerciseId\n                ) {\n                  return {\n                    ...exercise,\n                    sets: exercise.sets.map(set =>\n                      set.id === updatedSet.id ||\n                      set.tempId === updatedSet.tempId\n                        ? { ...set, ...updatedSet }\n                        : set\n                    )\n                  };\n                }\n                return exercise;\n              })\n            };\n          }\n          return workout;\n        })\n      };\n    }\n\n    case actionTypes.REMOVE_SET: {\n      const { workoutId, exerciseId, setId } = action.payload;\n      return {\n        ...state,\n        workouts: state.workouts.map(workout => {\n          if (workout.id === workoutId) {\n            return {\n              ...workout,\n              exercises: workout.exercises.map(exercise => {\n                if (\n                  exercise.id === exerciseId ||\n                  exercise.tempId === exerciseId\n                ) {\n                  return {\n                    ...exercise,\n                    sets: exercise.sets.filter(\n                      set => set.id !== setId && set.tempId !== setId\n                    )\n                  };\n                }\n                return exercise;\n              })\n            };\n          }\n          return workout;\n        })\n      };\n    }\n\n    default:\n      return state;\n  }\n}\n\nexport { workoutReducer };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}