{"ast":null,"code":"import { v4 as uuidv4 } from 'uuid';\nimport { actionTypes } from '../actions/actionTypes';\nimport { initialState } from './initialState';\nfunction setReducer(state = {}, action) {\n  console.log('initialState.sets:', initialState.sets);\n  switch (action.type) {\n    case actionTypes.ADD_SET:\n      {\n        const {\n          exerciseId,\n          weight,\n          reps\n        } = action.payload;\n        const setId = uuidv4();\n        const newSet = {\n          id: setId,\n          weight,\n          reps,\n          order: (state[exerciseId] || []).length + 2\n        };\n        console.log('Adding new set:', newSet);\n        console.log('State before:', state);\n        const newState = {\n          ...state,\n          [exerciseId]: [...(state[exerciseId] || []), newSet]\n        };\n        console.log('State after:', newState);\n        return newState;\n      }\n    case actionTypes.UPDATE_SET:\n      {\n        const {\n          exerciseId,\n          updatedSet\n        } = action.payload;\n        console.log('Updating set:', updatedSet);\n\n        // Ensure the state for exerciseId is an array before using map\n        const currentSets = state[exerciseId] || [];\n        console.log('Current sets:', currentSets);\n        return {\n          ...state,\n          [exerciseId]: state[exerciseId].map(set => set.id === updatedSet.id ? {\n            ...set,\n            ...updatedSet\n          } : set)\n        };\n      }\n    case actionTypes.DELETE_SET:\n      {\n        var _state$exercises;\n        const {\n          exerciseId,\n          setId\n        } = action.payload;\n        console.log('Deleting set with id:', setId);\n\n        // Get all the sets for the exercise, including the ined from the exercise object and the state\n        const exerciseSets = state[exerciseId] || [];\n        console.log('exerciseSets:', exerciseSets);\n        const exercise = (_state$exercises = state.exercises) === null || _state$exercises === void 0 ? void 0 : _state$exercises.find(ex => ex.id === exerciseId);\n        console.log('exercise:', exercise);\n        const initialState = exercise ? exercise.sets : [];\n        console.log('initialState:', initialState);\n\n        // Combine the initial sets with the state sets\n        const allSets = [...initialState, ...exerciseSets];\n        console.log('allSets:', allSets);\n\n        // Filter out the set to delete\n        const updatedSets = allSets.filter(set => set.id !== setId);\n\n        // Recalculate the order of the remaining sets\n        const reorderedSets = updatedSets.map((set, index) => ({\n          ...set,\n          order: index + 1\n        }));\n        return {\n          ...state,\n          [exerciseId]: reorderedSets\n        };\n      }\n    default:\n      return state;\n  }\n}\nexport { setReducer };","map":{"version":3,"names":["v4","uuidv4","actionTypes","initialState","setReducer","state","action","console","log","sets","type","ADD_SET","exerciseId","weight","reps","payload","setId","newSet","id","order","length","newState","UPDATE_SET","updatedSet","currentSets","map","set","DELETE_SET","_state$exercises","exerciseSets","exercise","exercises","find","ex","allSets","updatedSets","filter","reorderedSets","index"],"sources":["/Users/mike/Documents/purple.nosync/pow/web-frontend/src/reducers/setReducer.js"],"sourcesContent":["import { v4 as uuidv4 } from 'uuid';\nimport { actionTypes } from '../actions/actionTypes';\nimport { initialState } from './initialState';\n\nfunction setReducer(state = {}, action) {\n  console.log('initialState.sets:', initialState.sets);\n  switch (action.type) {\n    case actionTypes.ADD_SET: {\n      const { exerciseId, weight, reps } = action.payload;\n      const setId = uuidv4();\n      const newSet = {\n        id: setId,\n        weight,\n        reps,\n        order: (state[exerciseId] || []).length + 2\n      };\n\n      console.log('Adding new set:', newSet);\n      console.log('State before:', state);\n\n      const newState = {\n        ...state,\n        [exerciseId]: [...(state[exerciseId] || []), newSet]\n      };\n\n      console.log('State after:', newState);\n\n      return newState;\n    }\n\n    case actionTypes.UPDATE_SET: {\n      const { exerciseId, updatedSet } = action.payload;\n      console.log('Updating set:', updatedSet);\n\n      // Ensure the state for exerciseId is an array before using map\n      const currentSets = state[exerciseId] || [];\n      console.log('Current sets:', currentSets);\n\n      return {\n        ...state,\n        [exerciseId]: state[exerciseId].map(set =>\n          set.id === updatedSet.id ? { ...set, ...updatedSet } : set\n        )\n      };\n    }\n\n    case actionTypes.DELETE_SET: {\n      const { exerciseId, setId } = action.payload;\n      console.log('Deleting set with id:', setId);\n\n      // Get all the sets for the exercise, including the ined from the exercise object and the state\n      const exerciseSets = state[exerciseId] || [];\n      console.log('exerciseSets:', exerciseSets);\n      const exercise = state.exercises?.find(ex => ex.id === exerciseId);\n      console.log('exercise:', exercise);\n      const initialState = exercise ? exercise.sets : [];\n      console.log('initialState:', initialState);\n\n      // Combine the initial sets with the state sets\n      const allSets = [...initialState, ...exerciseSets];\n      console.log('allSets:', allSets);\n\n      // Filter out the set to delete\n      const updatedSets = allSets.filter(set => set.id !== setId);\n\n      // Recalculate the order of the remaining sets\n      const reorderedSets = updatedSets.map((set, index) => ({\n        ...set,\n        order: index + 1\n      }));\n\n      return {\n        ...state,\n        [exerciseId]: reorderedSets\n      };\n    }\n    default:\n      return state;\n  }\n}\n\nexport { setReducer };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}